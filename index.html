<!DOCTYPE html>
<html lang="ru">

<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>–ë–∞–∑–∞ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç–µ–π</title>
 <link rel="shortcut icon" href="https://vk.com/images/emoji/2B50_2x.png" type="image/x-icon">
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.css" rel="stylesheet">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.css">
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 <link rel="stylesheet" href="style.css">
 <script src="config.js"></script>
</head>

<body>
 <nav class="navbar navbar-dark bg-dark mb-4">
  <div class="container">
   <span class="navbar-brand mb-0 h1">
    <i class="fas fa-star me-2"></i>–ë–∞–∑–∞ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç–µ–π
   </span>
  </div>
 </nav>

 <div class="container">
  <div class="row">
   <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
   <div class="col-lg-5">
    <details class="add-form">
     <summary>
      <h4><i class="fas fa-plus-circle feature-icon"></i>–î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å</h4>
     </summary>

     <div class="mb-3">
      <label class="form-label">–ò–º—è *</label>
      <input type="text" class="form-control" id="celebName" required placeholder="–ù–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º">
      <!-- –î–û–ë–ê–í–õ–Ø–ï–ú –°–¢–†–û–ö–£ –°–¢–ê–¢–£–°–ê -->
      <div id="nameStatus" class="form-text"></div>
     </div>

     <div class="mb-3">
      <label class="form-label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
      <input type="date" class="form-control" id="celebBirthDate">
      <div class="form-text">–í–æ–∑—Ä–∞—Å—Ç –∏ –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>
     </div>

     <!-- –ü–æ–ª–µ "–£–º–µ—Ä" -->
     <div class="mb-3">
      <div class="form-check">
       <input class="form-check-input" type="checkbox" id="celebIsDeceased">
       <label class="form-check-label" for="celebIsDeceased">
        ‚ùå –ù–µ—Ç –≤ –∂–∏–≤—ã—Ö
       </label>
      </div>
     </div>

     <!-- –î–∞—Ç–∞ —Å–º–µ—Ä—Ç–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ "–£–º–µ—Ä") -->
     <div class="mb-3" id="deathDateField" style="display: none;">
      <label class="form-label">–î–∞—Ç–∞ —Å–º–µ—Ä—Ç–∏</label>
      <input type="date" class="form-control" id="celebDeathDate">
      <div class="form-text">–í–æ–∑—Ä–∞—Å—Ç –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–º–µ—Ä—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>
     </div>

     <div class="mb-3 optional-field">
      <label class="form-label">–†–æ—Å—Ç (—Å–º)</label>
      <input type="number" class="form-control" id="celebHeight" placeholder="–ù–µ —É–∫–∞–∑–∞–Ω–æ">
     </div>

     <div class="mb-3">
      <label class="form-label">–¶–≤–µ—Ç –≤–æ–ª–æ—Å *</label>
      <select class="form-select" id="celebHairColor" multiple size="3" required>
       <option value="–±–ª–æ–Ω–¥–∏–Ω">–ë–ª–æ–Ω–¥–∏–Ω</option>
       <option value="–±—Ä—é–Ω–µ—Ç">–ë—Ä—é–Ω–µ—Ç</option>
       <option value="—Ä—ã–∂–∏–π">–†—ã–∂–∏–π</option>
       <option value="—à–∞—Ç–µ–Ω">–®–∞—Ç–µ–Ω</option>
       <option value="—Å–µ–¥–æ–π">–°–µ–¥–æ–π</option>
       <option value="–¥—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
      </select>
      <div class="form-text">–ó–∞–∂–º–∏—Ç–µ Ctrl –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</div>
     </div>

     <!-- –î–û–ë–ê–í–õ–Ø–ï–ú –¶–í–ï–¢ –ì–õ–ê–ó -->
     <div class="mb-3">
      <label class="form-label">–¶–≤–µ—Ç –≥–ª–∞–∑</label>
      <select class="form-select" id="celebEyeColor" multiple size="4">
       <option value="–≥–æ–ª—É–±—ã–µ">üîµ –ì–æ–ª—É–±—ã–µ</option>
       <option value="–∑–µ–ª—ë–Ω—ã–µ">üü¢ –ó–µ–ª—ë–Ω—ã–µ</option>
       <option value="–∫–∞—Ä–∏–µ">üü§ –ö–∞—Ä–∏–µ</option>
       <option value="—Å–µ—Ä—ã–µ">‚ö™ –°–µ—Ä—ã–µ</option>
       <option value="—è–Ω—Ç–∞—Ä–Ω—ã–µ">üü† –Ø–Ω—Ç–∞—Ä–Ω—ã–µ</option>
       <option value="–æ—Ä–µ—Ö–æ–≤—ã–µ">üü§ –û—Ä–µ—Ö–æ–≤—ã–µ</option>
       <option value="—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ">üü£ –§–∏–æ–ª–µ—Ç–æ–≤—ã–µ</option>
       <option value="–∫—Ä–∞—Å–Ω—ã–µ">üî¥ –ö—Ä–∞—Å–Ω—ã–µ (–∞–ª—å–±–∏–Ω–∏–∑–º)</option>
       <option value="—á—ë—Ä–Ω—ã–µ">‚ö´ –ß—ë—Ä–Ω—ã–µ</option>
       <option value="–≥–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏—è">üëÅÔ∏è –ì–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏—è (—Ä–∞–∑–Ω—ã–µ –≥–ª–∞–∑–∞)</option>
       <option value="–¥—Ä—É–≥–æ–µ">‚ùì –î—Ä—É–≥–æ–π —Ü–≤–µ—Ç</option>
      </select>
      <div class="form-text">–ó–∞–∂–º–∏—Ç–µ Ctrl –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤. –î–ª—è –≥–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏–∏ —É–∫–∞–∂–∏—Ç–µ
       –æ–±–∞ —Ü–≤–µ—Ç–∞.</div>
      <div class="selected-eye-colors mt-2" id="selectedEyeColors"></div>
     </div>

     <div class="mb-3">
      <label class="form-label">–≠—Ç–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å</label>
      <select class="form-select" id="celebEthnicity" multiple size="4">
       <option value="european">–ï–≤—Ä–æ–ø–µ–π—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="east-asian">–í–æ—Å—Ç–æ—á–Ω–æ–∞–∑–∏–∞—Ç—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="south-asian">–Æ–∂–Ω–æ–∞–∑–∏–∞—Ç—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="african">–ê—Ñ—Ä–∏–∫–∞–Ω—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="latin">–õ–∞—Ç–∏–Ω–æ–∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="middle-eastern">–ë–ª–∏–∂–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="indigenous">–ö–æ—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Ä–æ–¥—ã –ê–º–µ—Ä–∏–∫–∏</option>
       <option value="pacific">–û–∫–µ–∞–Ω–∏–π—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="mixed">–°–º–µ—à–∞–Ω–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
       <option value="other">–î—Ä—É–≥–æ–µ</option>
      </select>
      <div class="form-text">–ó–∞–∂–º–∏—Ç–µ Ctrl/Cmd –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</div>
      <div class="selected-ethnicities mt-2" id="selectedEthnicities"></div>
     </div>

     <div class="mb-3">
      <label class="form-label">–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ</label>
      <div class="country-search-container">
       <input type="text" class="form-control" id="countrySearch" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã">
       <div class="country-dropdown" id="countryDropdown"></div>
      </div>
      <div class="selected-countries" id="selectedCountries"></div>
     </div>

     <div class="mb-3">
      <label class="form-label">–ü–æ–ª *</label>
      <div class="d-flex gap-4">
       <div class="form-check">
        <input class="form-check-input" type="radio" name="celebGender" id="genderMale" value="–º—É–∂—á–∏–Ω–∞" required>
        <label class="form-check-label" for="genderMale">
         <i class="fas fa-mars text-primary me-1"></i>–ú—É–∂—á–∏–Ω–∞
        </label>
       </div>
       <div class="form-check">
        <input class="form-check-input" type="radio" name="celebGender" id="genderFemale" value="–∂–µ–Ω—â–∏–Ω–∞">
        <label class="form-check-label" for="genderFemale">
         <i class="fas fa-venus text-danger me-1"></i>–ñ–µ–Ω—â–∏–Ω–∞
        </label>
       </div>
      </div>
     </div>

     <div class="mb-3">
      <label class="form-label">–°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ *</label>
      <select class="form-select" id="celebOccupation" multiple size="4" required>
       <option value="–∞–∫—Ç—ë—Ä">–ê–∫—Ç—ë—Ä</option>
       <option value="–º—É–∑—ã–∫–∞–Ω—Ç">–ú—É–∑—ã–∫–∞–Ω—Ç</option>
       <option value="—Å–ø–æ—Ä—Ç—Å–º–µ–Ω">–°–ø–æ—Ä—Ç—Å–º–µ–Ω</option>
       <option value="–º–æ–¥–µ–ª—å">–ú–æ–¥–µ–ª—å</option>
       <option value="–±–ª–æ–≥–µ—Ä">–ë–ª–æ–≥–µ—Ä</option>
       <option value="–¥—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
      </select>
      <div class="form-text">–ó–∞–∂–º–∏—Ç–µ Ctrl/Cmd –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</div>
      <div class="selected-occupations mt-2" id="selectedOccupations"></div>
     </div>

     <!-- –ó–ê–ú–ï–ù–ê –ó–ê–ì–†–£–ó–ö–ò –§–ê–ô–õ–ê –ù–ê –°–°–´–õ–ö–£ -->
     <div class="mb-3">
      <label class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é</label>
      <input type="url" class="form-control" id="celebPhotoUrl" placeholder="https://example.com/photo.jpg">
      <div class="form-text">–í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
      <img id="photoPreview" class="photo-preview" style="display:none;">
     </div>

     <button class="btn btn-purple w-100" id="submitButton" onclick="handleSubmit()">
      <i class="fas fa-plus me-1"></i> –î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å
     </button>
     <button class="btn btn-outline-secondary w-100 mt-2" id="cancelEditButton" onclick="cancelEdit()"
      style="display: none;">
      <i class="fas fa-times me-1"></i> –û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
     </button>
    </details>

    <!-- –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –±–ª–æ–∫ –ø–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å" -->
    <div class="mt-3">
     <input type="text" class="form-control mb-2" id="gistIdInput" placeholder="–í–≤–µ–¥–∏—Ç–µ ID Gist"
      value="a69c7957121ab29b4ed27368671fbbda">
     <button class="btn btn-success w-100 mb-2" onclick="loadFromGist()">
      üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –∏–∑ Gist
     </button>
     <button class="btn btn-primary w-100" onclick="saveToGist()">
      üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –±–∞–∑—É Gist
     </button>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º -->
    <div class="mt-3">
     <h5><i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º</h5>
     <div class="input-group mb-2">
      <input type="text" class="form-control" id="addUserInput" placeholder="GitHub –ª–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
      <button class="btn btn-success" onclick="addTrustedUser()">–î–æ–±–∞–≤–∏—Ç—å</button>
     </div>
     <div id="trustedUsersList" class="mb-2"></div>
     <small class="text-muted">–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–æ–º</small>
    </div>
   </div>

   <!-- –°–ø–∏—Å–æ–∫ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç–µ–π -->
   <div class="col-lg-7">
    <details class="filter-section">
     <summary>
      <h4><i class="fas fa-filter feature-icon"></i>–§–∏–ª—å—Ç—Ä—ã</h4>
      <div class="dropdown">
       <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="sortDropdown"
        data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-sort"></i> –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
       </button>
       <ul class="dropdown-menu" aria-labelledby="sortDropdown">
        <li><a class="dropdown-item" href="" onclick="changeSortOrder('newest')">
          <i class="fas fa-sort-amount-down-alt"></i> –°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ
         </a></li>
        <li><a class="dropdown-item" href="" onclick="changeSortOrder('oldest')">
          <i class="fas fa-sort-amount-up-alt"></i> –°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ
         </a></li>
        <li>
         <hr class="dropdown-divider">
        </li>
        <li><a class="dropdown-item" href="" onclick="changeSortOrder('az')">
          <i class="fas fa-sort-alpha-down"></i> –ê-–Ø / A-Z
         </a></li>
        <li><a class="dropdown-item" href="" onclick="changeSortOrder('za')">
          <i class="fas fa-sort-alpha-up-alt"></i> –Ø-–ê / Z-A
         </a></li>
       </ul>
      </div>
     </summary>


     <div class="row filter-row">
      <div class="col-md-6 mb-3">
       <label class="form-label">–¶–≤–µ—Ç –≤–æ–ª–æ—Å</label>
       <select class="form-select" id="filterHairColor">
        <option value="">–í—Å–µ</option>
        <option value="–±–ª–æ–Ω–¥–∏–Ω">–ë–ª–æ–Ω–¥–∏–Ω</option>
        <option value="–±—Ä—é–Ω–µ—Ç">–ë—Ä—é–Ω–µ—Ç</option>
        <option value="—Ä—ã–∂–∏–π">–†—ã–∂–∏–π</option>
        <option value="—à–∞—Ç–µ–Ω">–®–∞—Ç–µ–Ω</option>
        <option value="—Å–µ–¥–æ–π">–°–µ–¥–æ–π</option>
        <option value="–¥—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
       </select>
      </div>
      <div class="col-md-6 mb-3">
       <label class="form-label">–°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</label>
       <select class="form-select" id="filterOccupation">
        <option value="">–í—Å–µ</option>
        <option value="–∞–∫—Ç—ë—Ä">–ê–∫—Ç—ë—Ä</option>
        <option value="–º—É–∑—ã–∫–∞–Ω—Ç">–ú—É–∑—ã–∫–∞–Ω—Ç</option>
        <option value="—Å–ø–æ—Ä—Ç—Å–º–µ–Ω">–°–ø–æ—Ä—Ç—Å–º–µ–Ω</option>
        <option value="–º–æ–¥–µ–ª—å">–ú–æ–¥–µ–ª—å</option>
        <option value="–±–ª–æ–≥–µ—Ä">–ë–ª–æ–≥–µ—Ä</option>
        <option value="–¥—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
       </select>
      </div>
     </div>

     <div class="row filter-row">
      <div class="col-md-6 mb-3">
       <label class="form-label">–ü–æ–ª</label>
       <select class="form-select" id="filterGender">
        <option value="">–í—Å–µ</option>
        <option value="–º—É–∂—á–∏–Ω–∞">–ú—É–∂—á–∏–Ω–∞</option>
        <option value="–∂–µ–Ω—â–∏–Ω–∞">–ñ–µ–Ω—â–∏–Ω–∞</option>
       </select>
      </div>

      <div class="col-md-6 mb-3">
       <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
       <select class="form-select" id="filterStatus">
        <option value="">–í—Å–µ</option>
        <option value="alive">–ñ–∏–≤—ã–µ</option>
        <option value="deceased">–£–º–µ—Ä—à–∏–µ</option>
       </select>
      </div>
     </div>

     <!-- –§–ò–õ–¨–¢–† –ü–û –¶–í–ï–¢–£ –ì–õ–ê–ó -->
     <div class="row filter-row">
      <div class="col-md-6 mb-3">
       <label class="form-label">–¶–≤–µ—Ç –≥–ª–∞–∑</label>
       <select class="form-select" id="filterEyeColor">
        <option value="">–í—Å–µ</option>
        <option value="–≥–æ–ª—É–±—ã–µ">–ì–æ–ª—É–±—ã–µ</option>
        <option value="–∑—ë–ª–µ–Ω—ã–µ">–ó—ë–ª–µ–Ω—ã–µ</option>
        <option value="–∫–∞—Ä–∏–µ">–ö–∞—Ä–∏–µ</option>
        <option value="—Å–µ—Ä—ã–µ">–°–µ—Ä—ã–µ</option>
        <option value="—è–Ω—Ç–∞—Ä–Ω—ã–µ">–Ø–Ω—Ç–∞—Ä–Ω—ã–µ</option>
        <option value="–æ—Ä–µ—Ö–æ–≤—ã–µ">–û—Ä–µ—Ö–æ–≤—ã–µ</option>
        <option value="—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ">–§–∏–æ–ª–µ—Ç–æ–≤—ã–µ</option>
        <option value="–∫—Ä–∞—Å–Ω—ã–µ">–ö—Ä–∞—Å–Ω—ã–µ</option>
        <option value="—á—ë—Ä–Ω—ã–µ">–ß—ë—Ä–Ω—ã–µ</option>
        <option value="–≥–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏—è">–ì–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏—è</option>
        <option value="–¥—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
       </select>
      </div>
      <div class="col-md-6 mb-3">
       <label class="form-label">–≠—Ç–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å</label>
       <select class="form-select" id="filterEthnicity">
        <option value="">–í—Å–µ</option>
        <option value="european">–ï–≤—Ä–æ–ø–µ–π—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="east-asian">–í–æ—Å—Ç–æ—á–Ω–æ–∞–∑–∏–∞—Ç—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="south-asian">–Æ–∂–Ω–æ–∞–∑–∏–∞—Ç—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="african">–ê—Ñ—Ä–∏–∫–∞–Ω—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="latin">–õ–∞—Ç–∏–Ω–æ–∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="middle-eastern">–ë–ª–∏–∂–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="indigenous">–ö–æ—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Ä–æ–¥—ã –ê–º–µ—Ä–∏–∫–∏</option>
        <option value="pacific">–û–∫–µ–∞–Ω–∏–π—Å–∫–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="mixed">–°–º–µ—à–∞–Ω–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</option>
        <option value="other">–î—Ä—É–≥–æ–µ</option>
       </select>
      </div>
     </div>

     <div class="row filter-row">
      <div class="col-md-6 mb-3">
       <label class="form-label">–ó–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞</label>
       <select class="form-select" id="filterZodiac">
        <option value="">–í—Å–µ</option>
        <option value="–û–≤–µ–Ω">–û–≤–µ–Ω</option>
        <option value="–¢–µ–ª–µ—Ü">–¢–µ–ª–µ—Ü</option>
        <option value="–ë–ª–∏–∑–Ω–µ—Ü—ã">–ë–ª–∏–∑–Ω–µ—Ü—ã</option>
        <option value="–†–∞–∫">–†–∞–∫</option>
        <option value="–õ–µ–≤">–õ–µ–≤</option>
        <option value="–î–µ–≤–∞">–î–µ–≤–∞</option>
        <option value="–í–µ—Å—ã">–í–µ—Å—ã</option>
        <option value="–°–∫–æ—Ä–ø–∏–æ–Ω">–°–∫–æ—Ä–ø–∏–æ–Ω</option>
        <option value="–°—Ç—Ä–µ–ª–µ—Ü">–°—Ç—Ä–µ–ª–µ—Ü</option>
        <option value="–ö–æ–∑–µ—Ä–æ–≥">–ö–æ–∑–µ—Ä–æ–≥</option>
        <option value="–í–æ–¥–æ–ª–µ–π">–í–æ–¥–æ–ª–µ–π</option>
        <option value="–†—ã–±—ã">–†—ã–±—ã</option>
       </select>
      </div>
      <div class="col-md-6 mb-3">
       <label class="form-label">–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ</label>
       <input type="text" class="form-control" id="filterCitizenship" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É">
      </div>
     </div>

     <div class="row filter-row">
      <div class="col-md-6 mb-3">
       <label class="form-label">–í–æ–∑—Ä–∞—Å—Ç –æ—Ç</label>
       <input type="number" class="form-control" id="filterAgeMin" placeholder="0" min="0" max="120">
      </div>
      <div class="col-md-6 mb-3">
       <label class="form-label">–í–æ–∑—Ä–∞—Å—Ç –¥–æ</label>
       <input type="number" class="form-control" id="filterAgeMax" placeholder="100" min="0" max="120">
      </div>
     </div>

     <div class="row filter-row">
      <div class="col-md-6 mb-3">
       <label class="form-label">–†–æ—Å—Ç –æ—Ç (—Å–º)</label>
       <input type="number" class="form-control" id="filterHeightMin" placeholder="0" min="50" max="250">
      </div>
      <div class="col-md-6 mb-3">
       <label class="form-label">–†–æ—Å—Ç –¥–æ (—Å–º)</label>
       <input type="number" class="form-control" id="filterHeightMax" placeholder="250" min="50" max="250">
      </div>
     </div>

     <div class="row filter-row">
      <div class="col-12 mb-3">
       <label class="form-label">–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏</label>
       <input type="text" class="form-control" id="filterName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
      </div>
     </div>

     <button class="btn btn-primary w-100" onclick="applyFilters()">
      <i class="fas fa-filter me-1"></i> –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
     </button>
     <button class="btn btn-outline-secondary w-100 mt-2" onclick="resetFilters()">
      <i class="fas fa-times me-1"></i> –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
     </button>
    </details>

    <div class="d-flex justify-content-between align-items-center mb-3">
     <h4><i class="fas fa-list feature-icon"></i>–ö–∞—Ç–∞–ª–æ–≥ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç–µ–π</h4>
     <span class="badge bg-primary" id="celebCount">0</span>
    </div>

    <div class="row" id="celebritiesList">
     <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
    </div>
   </div>
  </div>
 </div>

 <script>
  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ –≤ –º–∞—Å—Å–∏–≤—ã)
  function normalizeCelebrityData(celeb) {
   // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º occupation
   if (celeb.occupation && typeof celeb.occupation === 'string') {
    celeb.occupation = [celeb.occupation];
   }

   // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º ethnicity
   if (celeb.ethnicity && typeof celeb.ethnicity === 'string') {
    celeb.ethnicity = [celeb.ethnicity];
   }

   // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º hairColor (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞)
   if (celeb.hairColor && typeof celeb.hairColor === 'string') {
    celeb.hairColor = [celeb.hairColor];
   }

   // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º eyeColor (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞)
   if (celeb.eyeColor && typeof celeb.eyeColor === 'string') {
    celeb.eyeColor = [celeb.eyeColor];
   }

   // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º citizenship (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞)
   if (celeb.citizenship && typeof celeb.citizenship === 'string') {
    celeb.citizenship = [celeb.citizenship];
   }

   if (!celeb.createdAt) {
    celeb.createdAt = new Date().toISOString();
   }

   return celeb;
  }

  // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –ø–æ–ª—è –¥–∞—Ç—ã —Å–º–µ—Ä—Ç–∏
  document.getElementById('celebIsDeceased').addEventListener('change', function () {
   const deathDateField = document.getElementById('deathDateField');
   deathDateField.style.display = this.checked ? 'block' : 'none';

   if (!this.checked) {
    document.getElementById('celebDeathDate').value = '';
   }
  });

  // ===== –ü–†–û–°–¢–û–ô –í–´–ë–û–† –°–¢–†–ê–ù =====
  const countries = [
   { name: "–†–æ—Å—Å–∏—è", flag: "üá∑üá∫" },
   { name: "–°–®–ê", flag: "üá∫üá∏" },
   { name: "–ì–µ—Ä–º–∞–Ω–∏—è", flag: "üá©üá™" },
   { name: "–§—Ä–∞–Ω—Ü–∏—è", flag: "üá´üá∑" },
   { name: "–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è", flag: "üá¨üáß" },
   { name: "–ò—Ç–∞–ª–∏—è", flag: "üáÆüáπ" },
   { name: "–ò—Å–ø–∞–Ω–∏—è", flag: "üá™üá∏" },
   { name: "–ö–∏—Ç–∞–π", flag: "üá®üá≥" },
   { name: "–Ø–ø–æ–Ω–∏—è", flag: "üáØüáµ" },
   { name: "–§–∏–Ω–ª—è–Ω–¥–∏—è", flag: "üá´üáÆ" },
   { name: "–í–µ–Ω–≥—Ä–∏—è", flag: "üá≠üá∫" },
   { name: "–®–≤–µ—Ü–∏—è", flag: "üá∏üá™" },
   { name: "–ù–æ—Ä–≤–µ–≥–∏—è", flag: "üá≥üá¥" },
   { name: "–î–∞–Ω–∏—è", flag: "üá©üá∞" },
   { name: "–ö–∞–Ω–∞–¥–∞", flag: "üá®üá¶" },
   { name: "–ê–≤—Å—Ç—Ä–∞–ª–∏—è", flag: "üá¶üá∫" },
   { name: "–ù–æ–≤–∞—è –ó–µ–ª–∞–Ω–¥–∏—è", flag: "üá≥üáø" },
   { name: "–ò—Ä–ª–∞–Ω–¥–∏—è", flag: "üáÆüá™" },
   { name: "–ú–µ–∫—Å–∏–∫–∞", flag: "üá≤üáΩ" },
   { name: "–ë—Ä–∞–∑–∏–ª–∏—è", flag: "üáßüá∑" },
   { name: "–ê—Ä–≥–µ–Ω—Ç–∏–Ω–∞", flag: "üá¶üá∑" },
   { name: "–Æ–∂–Ω–∞—è –ö–æ—Ä–µ—è", flag: "üá∞üá∑" },
   { name: "–ò–Ω–¥–∏—è", flag: "üáÆüá≥" },
   { name: "–¢—É—Ä—Ü–∏—è", flag: "üáπüá∑" },
   { name: "–£–∫—Ä–∞–∏–Ω–∞", flag: "üá∫üá¶" },
   { name: "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω", flag: "üá∞üáø" },
   { name: "–ò–∑—Ä–∞–∏–ª—å", flag: "üáÆüá±" },
   { name: "–ì–æ–Ω–∫–æ–Ω–≥", flag: "üá≠üá∞" },
   { name: "–Æ–ê–†", flag: "üáøüá¶" },
   { name: "–ö–æ–ª—É–º–±–∏—è", flag: "üá®üá¥" },
   { name: "–ß–∏–ª–∏", flag: "üá®üá±" },
   { name: "–¥—Ä—É–≥–æ–µ", flag: "üè≥Ô∏è" }
  ];

  let selectedCountries = [];
  let selectedEyeColors = [];
  let selectedEthnicities = [];
  let selectedOccupations = [];
  let editingCelebrityId = null; // –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è ID —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
  let currentPage = 1;
  const itemsPerPage = 20; // –ø–æ 20 –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
  let filteredData = []; // –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  const ADMIN_USERNAME = 'alexkolmar'; // –ó–ê–ú–ï–ù–ò –Ω–∞ —Å–≤–æ–π GitHub –ª–æ–≥–∏–Ω!
  let trustedUsers = [];
  let currentSortOrder = 'newest'; // newest, oldest, az, za

  // ===== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò =====
  let celebrities = [];

  const zodiacSigns = [
   { name: "–ö–æ–∑–µ—Ä–æ–≥", start: [12, 22], end: [1, 19] },
   { name: "–í–æ–¥–æ–ª–µ–π", start: [1, 20], end: [2, 18] },
   { name: "–†—ã–±—ã", start: [2, 19], end: [3, 20] },
   { name: "–û–≤–µ–Ω", start: [3, 21], end: [4, 19] },
   { name: "–¢–µ–ª–µ—Ü", start: [4, 20], end: [5, 20] },
   { name: "–ë–ª–∏–∑–Ω–µ—Ü—ã", start: [5, 21], end: [6, 20] },
   { name: "–†–∞–∫", start: [6, 21], end: [7, 22] },
   { name: "–õ–µ–≤", start: [7, 23], end: [8, 22] },
   { name: "–î–µ–≤–∞", start: [8, 23], end: [9, 22] },
   { name: "–í–µ—Å—ã", start: [9, 23], end: [10, 22] },
   { name: "–°–∫–æ—Ä–ø–∏–æ–Ω", start: [10, 23], end: [11, 21] },
   { name: "–°—Ç—Ä–µ–ª–µ—Ü", start: [11, 22], end: [12, 21] }
  ];

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM
  document.addEventListener('DOMContentLoaded', function () {
   console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º...');
   loadData();
   loadTrustedUsers(); // ‚Üê –î–û–ë–ê–í–¨ –≠–¢–£ –°–¢–†–û–ß–ö–£
   setupEventListeners();
   setupCountrySearch();
   updateSortButtonText();
  });

  // –ù–ê–°–¢–†–û–ô–ö–ê –ü–û–ò–°–ö–ê –°–¢–†–ê–ù (–í–ï–†–ù–£–õ–ò –†–ê–ë–û–ß–£–Æ –í–ï–†–°–ò–Æ)
  function setupCountrySearch() {
   const searchInput = document.getElementById('countrySearch');
   const dropdown = document.getElementById('countryDropdown');

   if (!searchInput || !dropdown) {
    console.log('–≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Ç—Ä–∞–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ 100–º—Å...');
    setTimeout(setupCountrySearch, 100);
    return;
   }

   console.log('–≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω...');

   // –ü–æ–∫–∞–∑ dropdown –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
   searchInput.addEventListener('focus', function () {
    showCountryDropdown('');
   });

   // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ
   searchInput.addEventListener('input', function () {
    showCountryDropdown(this.value);
   });

   // –ó–∞–∫—Ä—ã—Ç–∏–µ dropdown –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
   document.addEventListener('click', function (e) {
    if (!dropdown.contains(e.target) && e.target !== searchInput) {
     dropdown.style.display = 'none';
    }
   });

   updateSelectedCountries();
  }

  function showCountryDropdown(filter) {
   const dropdown = document.getElementById('countryDropdown');
   if (!dropdown) return;

   dropdown.innerHTML = '';

   const filteredCountries = countries.filter(country =>
    country.name.toLowerCase().includes(filter.toLowerCase()) &&
    !selectedCountries.includes(country.name)
   );

   if (filteredCountries.length === 0) {
    dropdown.innerHTML = '<div class="country-item">–°—Ç—Ä–∞–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</div>';
    dropdown.style.display = 'block';
    return;
   }

   filteredCountries.forEach(country => {
    const div = document.createElement('div');
    div.className = 'country-item';
    div.innerHTML = `${country.flag} ${country.name}`;
    div.onclick = () => selectCountry(country);
    dropdown.appendChild(div);
   });

   dropdown.style.display = 'block';
  }

  function selectCountry(country) {
   if (!selectedCountries.includes(country.name)) {
    selectedCountries.push(country.name);
    updateSelectedCountries();
   }
   document.getElementById('countrySearch').value = '';
   document.getElementById('countryDropdown').style.display = 'none';
  }

  function updateSelectedCountries() {
   const container = document.getElementById('selectedCountries');
   if (!container) return;

   container.innerHTML = '';

   if (selectedCountries.length === 0) {
    container.innerHTML = '<span class="text-muted">–í—ã–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</span>';
    return;
   }

   selectedCountries.forEach(countryName => {
    const country = countries.find(c => c.name === countryName);
    const badge = document.createElement('span');
    badge.className = 'badge bg-primary me-1 mb-1';
    badge.innerHTML = `${country ? country.flag : 'üè≥Ô∏è'} ${countryName} 
                    <span style="cursor:pointer; margin-left:5px;" onclick="removeCountry('${countryName}')">√ó</span>`;
    container.appendChild(badge);
   });
  }

  function removeCountry(countryName) {
   selectedCountries = selectedCountries.filter(c => c !== countryName);
   updateSelectedCountries();
  }

  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ü–≤–µ—Ç–∞ –≥–ª–∞–∑
  function updateSelectedEyeColors() {
   const eyeSelect = document.getElementById('celebEyeColor');
   if (!eyeSelect) return; // ‚Üê –î–û–ë–ê–í–¨–¢–ï –≠–¢–£ –°–¢–†–û–ß–ö–£

   selectedEyeColors = Array.from(eyeSelect.selectedOptions)
    .map(opt => opt.value);

   const container = document.getElementById('selectedEyeColors');
   if (!container) return;

   container.innerHTML = '';

   if (selectedEyeColors.length === 0) {
    container.innerHTML = '<span class="text-muted">–¶–≤–µ—Ç–∞ –≥–ª–∞–∑ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</span>';
    return;
   }

   selectedEyeColors.forEach(color => {
    const badge = document.createElement('span');
    badge.className = 'badge eye-color-badge bg-light text-dark me-1 mb-1';
    badge.innerHTML = `${getEyeColorEmoji(color)} ${getEyeColorLabel(color)} 
                      <span style="cursor:pointer; margin-left:5px;" onclick="removeEyeColor('${color}')">√ó</span>`;
    container.appendChild(badge);
   });
  }
  function getEyeColorEmoji(color) {
   const emojis = {
    '–≥–æ–ª—É–±—ã–µ': 'üîµ',
    '–∑–µ–ª—ë–Ω—ã–µ': 'üü¢',
    '–∫–∞—Ä–∏–µ': 'üü§',
    '—Å–µ—Ä—ã–µ': '‚ö™',
    '—è–Ω—Ç–∞—Ä–Ω—ã–µ': 'üü†',
    '–æ—Ä–µ—Ö–æ–≤—ã–µ': 'üü§',
    '—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ': 'üü£',
    '–∫—Ä–∞—Å–Ω—ã–µ': 'üî¥',
    '—á—ë—Ä–Ω—ã–µ': '‚ö´',
    '–≥–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏—è': 'üëÅÔ∏è',
    '–¥—Ä—É–≥–æ–µ': '‚ùì'
   };
   return emojis[color] || 'üëÅÔ∏è';
  }

  function getEyeColorLabel(color) {
   const labels = {
    '–≥–æ–ª—É–±—ã–µ': '–ì–æ–ª—É–±—ã–µ',
    '–∑–µ–ª—ë–Ω—ã–µ': '–ó–µ–ª—ë–Ω—ã–µ',
    '–∫–∞—Ä–∏–µ': '–ö–∞—Ä–∏–µ',
    '—Å–µ—Ä—ã–µ': '–°–µ—Ä—ã–µ',
    '—è–Ω—Ç–∞—Ä–Ω—ã–µ': '–Ø–Ω—Ç–∞—Ä–Ω—ã–µ',
    '–æ—Ä–µ—Ö–æ–≤—ã–µ': '–û—Ä–µ—Ö–æ–≤—ã–µ',
    '—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ': '–§–∏–æ–ª–µ—Ç–æ–≤—ã–µ',
    '–∫—Ä–∞—Å–Ω—ã–µ': '–ö—Ä–∞—Å–Ω—ã–µ',
    '—á—ë—Ä–Ω—ã–µ': '–ß—ë—Ä–Ω—ã–µ',
    '–≥–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏—è': '–ì–µ—Ç–µ—Ä–æ—Ö—Ä–æ–º–∏—è',
    '–¥—Ä—É–≥–æ–µ': '–î—Ä—É–≥–æ–π'
   };
   return labels[color] || color;
  }

  function removeEyeColor(color) {
   const select = document.getElementById('celebEyeColor');
   const options = select.options;

   for (let i = 0; i < options.length; i++) {
    if (options[i].value === color) {
     options[i].selected = false;
     break;
    }
   }

   updateSelectedEyeColors();
  }

  function migrateOldData() {
   celebrities.forEach(celeb => {
    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º ethnicity –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤ –º–∞—Å—Å–∏–≤
    if (celeb.ethnicity && typeof celeb.ethnicity === 'string') {
     celeb.ethnicity = celeb.ethnicity ? [celeb.ethnicity] : [];
    }

    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º occupation –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤ –º–∞—Å—Å–∏–≤
    if (celeb.occupation && typeof celeb.occupation === 'string') {
     celeb.occupation = [celeb.occupation];
    }
   });
   saveData();
  }

  // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  function loadData() {
   const savedData = localStorage.getItem('celebritiesData');
   if (savedData) {
    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑ localStorage
    celebrities = JSON.parse(savedData).map(normalizeCelebrityData);
   }
   renderCelebrities();
  }

  function saveData() {
   localStorage.setItem('celebritiesData', JSON.stringify(celebrities));
   updateCount();
  }

  function updateCount() {
   const countElement = document.getElementById('celebCount');
   if (countElement) {
    countElement.textContent = celebrities.length;
   }
  }

  // ===== –§–£–ù–ö–¶–ò–Ø –ü–†–û–í–ï–†–ö–ò –ò–ú–ï–ù–ò =====
  function checkNameAvailability() {
   const nameInput = document.getElementById('celebName');
   const nameStatus = document.getElementById('nameStatus');
   const name = nameInput.value.trim();

   if (!name) {
    nameStatus.textContent = '';
    nameStatus.className = 'form-text';
    return;
   }

   // –ò—â–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∏–º—è (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞)
   const nameExists = celebrities.some(celeb =>
    celeb.name.toLowerCase() === name.toLowerCase()
   );

   if (nameExists) {
    nameStatus.textContent = '‚ö†Ô∏è –ü–µ—Ä—Å–æ–Ω–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ!';
    nameStatus.className = 'form-text name-exists';
   } else {
    nameStatus.textContent = '‚úÖ –ò–º—è —Å–≤–æ–±–æ–¥–Ω–æ';
    nameStatus.className = 'form-text name-available';
   }
  }

  function setupEventListeners() {
   // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ URL
   const photoUrlInput = document.getElementById('celebPhotoUrl');
   if (photoUrlInput) {
    photoUrlInput.addEventListener('input', function () {
     const url = this.value;
     const preview = document.getElementById('photoPreview');

     if (url) {
      preview.src = url;
      preview.style.display = 'block';
      preview.onerror = function () {
       preview.style.display = 'none';
      };
     } else {
      preview.style.display = 'none';
     }
    });
   }

   // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ü–≤–µ—Ç–∞ –≥–ª–∞–∑
   const eyeColorSelect = document.getElementById('celebEyeColor');
   if (eyeColorSelect) {
    eyeColorSelect.addEventListener('change', function () {
     updateSelectedEyeColors();
    });
   }

   // –í–∞–ª–∏–¥–∞—Ü–∏—è radio –∫–Ω–æ–ø–æ–∫ ‚Üê –î–û–ë–ê–í–¨ –≠–¢–û–¢ –ë–õ–û–ö
   document.querySelectorAll('input[name="celebGender"]').forEach(radio => {
    radio.addEventListener('change', function () {
     document.querySelectorAll('input[name="celebGender"]').forEach(r => {
      r.closest('.form-check').classList.remove('is-invalid');
     });
    });
   });

   // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ
   const nameInput = document.getElementById('celebName');
   if (nameInput) {
    nameInput.addEventListener('input', checkNameAvailability);
    // –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –µ—Å–ª–∏ –ø–æ–ª–µ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
    setTimeout(checkNameAvailability, 100);
   }

   // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
   const ethnicitySelect = document.getElementById('celebEthnicity');
   if (ethnicitySelect) {
    ethnicitySelect.addEventListener('change', updateSelectedEthnicities);
   }

   const occupationSelect = document.getElementById('celebOccupation');
   if (occupationSelect) {
    occupationSelect.addEventListener('change', updateSelectedOccupations);
   }

  }

  function getZodiacSign(birthDate) {
   if (!birthDate) return null;

   const date = new Date(birthDate);
   const day = date.getDate();
   const month = date.getMonth() + 1;

   for (const sign of zodiacSigns) {
    const [startMonth, startDay] = sign.start;
    const [endMonth, endDay] = sign.end;

    if ((month === startMonth && day >= startDay) ||
     (month === endMonth && day <= endDay)) {
     return sign.name;
    }
   }

   return "–ö–æ–∑–µ—Ä–æ–≥";
  }

  function calculateAge(birthDate) {
   if (!birthDate) return null;

   const today = new Date();
   const birth = new Date(birthDate);
   let age = today.getFullYear() - birth.getFullYear();

   const monthDiff = today.getMonth() - birth.getMonth();
   if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
    age--;
   }

   return age;
  }

  function calculateAgeAtDeath(birthDate, deathDate) {
   if (!birthDate || !deathDate) return null;

   const birth = new Date(birthDate);
   const death = new Date(deathDate);
   let age = death.getFullYear() - birth.getFullYear();

   const monthDiff = death.getMonth() - birth.getMonth();
   if (monthDiff < 0 || (monthDiff === 0 && death.getDate() < birth.getDate())) {
    age--;
   }

   return age;
  }

  function addCelebrity() {
   const name = document.getElementById('celebName').value;
   const birthDate = document.getElementById('celebBirthDate').value;
   const isDeceased = document.getElementById('celebIsDeceased').checked;
   const deathDate = document.getElementById('celebDeathDate').value;
   const ageAtDeath = deathDate ? calculateAgeAtDeath(birthDate, deathDate) : null;
   const height = document.getElementById('celebHeight').value;
   const hairColor = Array.from(document.getElementById('celebHairColor').selectedOptions)
    .map(opt => opt.value);
   const normalizedHairColor = hairColor.map(color => getBaseHairColor(color));
   const eyeColor = selectedEyeColors;
   const ethnicity = Array.from(document.getElementById('celebEthnicity').selectedOptions)
    .map(opt => opt.value);
   const occupation = Array.from(document.getElementById('celebOccupation').selectedOptions)
    .map(opt => opt.value);
   const gender = document.querySelector('input[name="celebGender"]:checked')?.value;
   const photoUrl = document.getElementById('celebPhotoUrl').value;

   if (!name || hairColor.length === 0 || !occupation) {
    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–∏–º—è, —Ü–≤–µ—Ç –≤–æ–ª–æ—Å, —Å—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)');
    return;
   }

   // –î–û–ë–ê–í–õ–Ø–ï–ú –ü–†–û–í–ï–†–ö–£ –ù–ê –°–£–©–ï–°–¢–í–£–Æ–©–ï–ï –ò–ú–Ø
   const nameExists = celebrities.some(celeb =>
    celeb.name.toLowerCase() === name.toLowerCase()
   );

   if (nameExists && !confirm('‚ö†Ô∏è –ü–µ—Ä—Å–æ–Ω–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ!\n\n–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
    return; // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
   }

   const age = calculateAge(birthDate);
   const zodiac = getZodiacSign(birthDate);

   const newCelebrity = {
    id: Date.now(),
    name: name,
    birthDate: birthDate,
    isDeceased: isDeceased,
    deathDate: deathDate || null,
    ageAtDeath: ageAtDeath,
    height: height || null,
    hairColor: normalizedHairColor,
    eyeColor: eyeColor,
    ethnicity: ethnicity || null,
    citizenship: [...selectedCountries],
    occupation: occupation,
    gender: gender,
    zodiac: zodiac,
    photo: photoUrl || `https://placeholder.darth-kolmar.workers.dev?w=300&h=200&bg=cccccc&fg=333333&txt=${encodeURIComponent(name)}`,
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString() // ‚Üê –î–û–ë–ê–í–¨–¢–ï –≠–¢–£ –°–¢–†–û–ß–ö–£
   };

   celebrities.push(newCelebrity);
   saveData();
   renderCelebrities();
   resetForm();

   alert('–ó–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
  }

  function resetForm() {
   if (editingCelebrityId) return;
   document.getElementById('celebName').value = '';
   document.getElementById('celebBirthDate').value = '';
   document.getElementById('celebIsDeceased').checked = false;
   document.getElementById('celebDeathDate').value = '';
   document.getElementById('deathDateField').style.display = 'none';
   document.getElementById('celebHeight').value = '';
   document.getElementById('celebHairColor').selectedIndex = -1;
   document.getElementById('celebEyeColor').selectedIndex = -1;
   document.getElementById('celebEthnicity').selectedIndex = -1;
   document.getElementById('celebOccupation').selectedIndex = -1;
   selectedEthnicities = [];
   selectedOccupations = [];
   updateSelectedEthnicities();
   updateSelectedOccupations();
   document.querySelectorAll('input[name="celebGender"]').forEach(radio => {
    radio.checked = false;
   });
   document.getElementById('celebPhotoUrl').value = '';
   document.getElementById('photoPreview').style.display = 'none';
   document.getElementById('countrySearch').value = '';
   selectedCountries = [];
   selectedEyeColors = [];
   updateSelectedCountries();
   updateSelectedEyeColors();

   // –î–û–ë–ê–í–õ–Ø–ï–ú –°–ë–†–û–° –°–¢–ê–¢–£–°–ê –ò–ú–ï–ù–ò
   const nameStatus = document.getElementById('nameStatus');
   nameStatus.textContent = '';
   nameStatus.className = 'form-text';
  }

  function resetFilters() {
   document.getElementById('filterHairColor').value = '';
   document.getElementById('filterOccupation').value = '';
   document.getElementById('filterGender').value = '';
   document.getElementById('filterStatus').value = '';
   document.getElementById('filterEyeColor').value = '';
   document.getElementById('filterEthnicity').value = '';
   document.getElementById('filterZodiac').value = '';
   document.getElementById('filterCitizenship').value = '';
   document.getElementById('filterAgeMin').value = '';
   document.getElementById('filterAgeMax').value = '';
   document.getElementById('filterHeightMin').value = '';
   document.getElementById('filterHeightMax').value = '';
   document.getElementById('filterName').value = '';

   renderCelebrities();

   filteredData = celebrities; // —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä
   currentPage = 1; // –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
   renderFilteredCelebrityPage(); // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º
  }

  function applyFilters() {
   const hairColor = document.getElementById('filterHairColor').value;
   const occupation = document.getElementById('filterOccupation').value;
   const gender = document.getElementById('filterGender').value;
   const status = document.getElementById('filterStatus').value; // ‚Üê –î–û–ë–ê–í–¨ –≠–¢–£ –°–¢–†–û–ß–ö–£
   const eyeColor = document.getElementById('filterEyeColor').value;
   const ethnicity = document.getElementById('filterEthnicity').value;
   const zodiac = document.getElementById('filterZodiac').value;
   const citizenship = document.getElementById('filterCitizenship').value.toLowerCase();
   const ageMin = parseInt(document.getElementById('filterAgeMin').value) || 0;
   const ageMax = parseInt(document.getElementById('filterAgeMax').value) || 100;
   const heightMin = parseInt(document.getElementById('filterHeightMin').value) || 0;
   const heightMax = parseInt(document.getElementById('filterHeightMax').value) || 250;
   const nameFilter = document.getElementById('filterName').value.toLowerCase();

   let filtered = celebrities.filter(celeb => {
    return (!hairColor || celeb.hairColor.includes(hairColor) ||
     (hairColor === '–±–ª–æ–Ω–¥–∏–Ω' && celeb.hairColor.includes('–±–ª–æ–Ω–¥–∏–Ω–∫–∞')) ||
     (hairColor === '–±–ª–æ–Ω–¥–∏–Ω–∫–∞' && celeb.hairColor.includes('–±–ª–æ–Ω–¥–∏–Ω')) ||
     (hairColor === '–±—Ä—é–Ω–µ—Ç' && celeb.hairColor.includes('–±—Ä—é–Ω–µ—Ç–∫–∞')) ||
     (hairColor === '–±—Ä—é–Ω–µ—Ç–∫–∞' && celeb.hairColor.includes('–±—Ä—é–Ω–µ—Ç')) ||
     (hairColor === '—à–∞—Ç–µ–Ω' && celeb.hairColor.includes('—à–∞—Ç–µ–Ω–∫–∞')) ||
     (hairColor === '—à–∞—Ç–µ–Ω–∫–∞' && celeb.hairColor.includes('—à–∞—Ç–µ–Ω')) ||
     (hairColor === '—Ä—ã–∂–∏–π' && celeb.hairColor.includes('—Ä—ã–∂–∞—è')) ||
     (hairColor === '—Ä—ã–∂–∞—è' && celeb.hairColor.includes('—Ä—ã–∂–∏–π')) ||
     (hairColor === '—Å–µ–¥–æ–π' && celeb.hairColor.includes('—Å–µ–¥–∞—è')) ||
     (hairColor === '—Å–µ–¥–∞—è' && celeb.hairColor.includes('—Å–µ–¥–æ–π'))) &&
     (!occupation || (celeb.occupation && celeb.occupation.includes(occupation)) ||
      (occupation === '–∞–∫—Ç—ë—Ä' && celeb.occupation === '–∞–∫—Ç—Ä–∏—Å–∞') ||
      (occupation === '–º—É–∑—ã–∫–∞–Ω—Ç' && celeb.occupation === '–º—É–∑—ã–∫–∞–Ω—Ç') ||
      (occupation === '—Å–ø–æ—Ä—Ç—Å–º–µ–Ω' && celeb.occupation === '—Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞') ||
      (occupation === '–±–ª–æ–≥–µ—Ä' && celeb.occupation === '–±–ª–æ–≥–µ—Ä—à–∞')) &&
     (!gender || celeb.gender === gender) &&
     (!status ||
      (status === 'alive' && !celeb.isDeceased) ||
      (status === 'deceased' && celeb.isDeceased)
     ) &&
     (!eyeColor || (celeb.eyeColor && celeb.eyeColor.includes(eyeColor))) &&
     (!ethnicity || (celeb.ethnicity && celeb.ethnicity.includes(ethnicity))) &&
     (!zodiac || celeb.zodiac === zodiac) &&
     (!citizenship || (celeb.citizenship && celeb.citizenship.some(c => c.toLowerCase().includes(citizenship)))) &&
     (!celeb.birthDate || (calculateAge(celeb.birthDate) >= ageMin && calculateAge(celeb.birthDate) <= ageMax)) &&
     (!celeb.height || (celeb.height >= heightMin && celeb.height <= heightMax)) &&
     (!nameFilter || celeb.name.toLowerCase().includes(nameFilter));
   });

   // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–∫—É—â—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –∫ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º
   switch (currentSortOrder) {
    case 'newest':
     filtered.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
     break;
    case 'oldest':
     filtered.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
     break;
    case 'az':
     filtered.sort((a, b) => a.name.localeCompare(b.name));
     break;
    case 'za':
     filtered.sort((a, b) => b.name.localeCompare(a.name));
     break;
   }

   filteredData = filtered;
   currentPage = 1;
   renderFilteredCelebrityPage();
  }

  function renderCelebrities() {
   // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
   const sortedCelebrities = [...celebrities].sort((a, b) => {
    return new Date(b.createdAt) - new Date(a.createdAt);
   });

   filteredData = sortedCelebrities; // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   currentPage = 1; // —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
   renderFilteredCelebrityPage(); // —Ä–µ–Ω–¥–µ—Ä–∏–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
  }

  function renderFilteredCelebrityPage() {
   const container = document.getElementById('celebritiesList');
   container.innerHTML = '';
   updateCount();

   if (filteredData.length === 0) {
    container.innerHTML = `
            <div class="col-12 text-center py-5">
                <i class="fas fa-search fa-3x mb-3 text-muted"></i>
                <h5 class="text-muted">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h5>
                <p class="text-muted">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</p>
            </div>
        `;
    // –£–¥–∞–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é –µ—Å–ª–∏ –µ—Å—Ç—å
    const oldPagination = document.getElementById('pagination');
    if (oldPagination) oldPagination.remove();
    return;
   }

   // –í—ã—á–∏—Å–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   const startIndex = (currentPage - 1) * itemsPerPage;
   const endIndex = startIndex + itemsPerPage;
   const pageData = filteredData.slice(startIndex, endIndex);

   // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞—Ä—Ç–æ—á–∫–∏
   pageData.forEach(celeb => {
    const card = document.createElement('div');
    card.className = 'col-md-6 mb-4';
    card.innerHTML = `
            <div class="card ${celeb.isDeceased ? 'deceased-card' : ''}">
                <div class="${celeb.isDeceased ? 'deceased-photo' : ''}">
    <img src="${celeb.photo}" class="celebrity-img" alt="${celeb.name}" onerror="this.src='https://placeholder.darth-kolmar.workers.dev?w=300&h=200&bg=cccccc&fg=333333&txt=${encodeURIComponent(celeb.name)}'">
</div>
                <div class="card-body">
                    <div class="card-actions" style="position: absolute; top: 10px; right: 10px;">
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="editCelebrity(${celeb.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteCelebrity(${celeb.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <h5 class="card-title">${celeb.name}</h5>
                    
                    <div class="mb-2">
    ${celeb.isDeceased ?
      `<span class="badge bg-dark">‚ùå ${getDeathWord(celeb.gender)} –≤ ${celeb.ageAtDeath} ${getAgeWord(celeb.ageAtDeath)}</span>` :
      (celeb.birthDate ? `<span class="badge bg-primary">${calculateAge(celeb.birthDate)} ${getAgeWord(calculateAge(celeb.birthDate))}</span>` : '')
     }
    ${celeb.zodiac ? `<span class="badge bg-info">${celeb.zodiac}</span>` : ''}
    ${celeb.height ? `<span class="badge bg-secondary">${celeb.height} —Å–º</span>` : ''}
</div>
                    
                    <div class="mb-2">
                        ${celeb.hairColor.map(color => `<span class="badge bg-purple">${getGenderHairColor(color, celeb.gender)}</span>`).join('')}
                        ${celeb.occupation.map(occ => `<span class="badge bg-success">${getGenderOccupation(occ, celeb.gender)}</span>`).join('')}
                        ${celeb.gender === '–º—É–∂—á–∏–Ω–∞' ?
      '<span class="badge bg-primary"><i class="fas fa-mars me-1"></i>–ú—É–∂—á–∏–Ω–∞</span>' :
      '<span class="badge bg-danger"><i class="fas fa-venus me-1"></i>–ñ–µ–Ω—â–∏–Ω–∞</span>'}
                    </div>
                    
                    ${celeb.eyeColor && celeb.eyeColor.length > 0 ?
      `<div class="mb-2">
                            <span class="badge bg-info">üëÅÔ∏è ${celeb.eyeColor.map(getEyeColorLabel).join(', ')}</span>
                        </div>` : ''}
                    
                    ${celeb.ethnicity && celeb.ethnicity.length > 0 ?
      `<div class="mb-1"><small>–ü—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ: ${celeb.ethnicity.map(e => getEthnicityLabel(e)).join(', ')}</small></div>` : ''}
                    ${celeb.citizenship && celeb.citizenship.length > 0 ?
      `<div class="mb-1"><small>–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ: ${celeb.citizenship.map(c => {
       const country = countries.find(cnt => cnt.name === c);
       return (country ? country.flag + ' ' : '') + c;
      }).join(', ')}</small></div>` : ''}
      ${celeb.lastEditedBy ? `<small class="text-muted">–ò–∑–º–µ–Ω–µ–Ω–æ: ${celeb.lastEditedBy}</small>` : ''}
      ${celeb.mergeType === 'conflict' ?
      '<span class="badge bg-warning">‚ö†Ô∏è –ö–æ–Ω—Ñ–ª–∏–∫—Ç</span>' : ''}
                </div>
            </div>
        `;
    container.appendChild(card);
   });

   renderPagination(filteredData.length);
  }

  function getEthnicityLabel(value) {
   const labels = {
    'european': '–ï–≤—Ä–æ–ø–µ–π—Å–∫–æ–µ',
    'east-asian': '–í–æ—Å—Ç–æ—á–Ω–æ–∞–∑–∏–∞—Ç—Å–∫–æ–µ',
    'south-asian': '–Æ–∂–Ω–æ–∞–∑–∏–∞—Ç—Å–∫–æ–µ',
    'african': '–ê—Ñ—Ä–∏–∫–∞–Ω—Å–∫–æ–µ',
    'latin': '–õ–∞—Ç–∏–Ω–æ–∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–æ–µ',
    'middle-eastern': '–ë–ª–∏–∂–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–æ–µ',
    'indigenous': '–ö–æ—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Ä–æ–¥—ã –ê–º–µ—Ä–∏–∫–∏',
    'pacific': '–û–∫–µ–∞–Ω–∏–π—Å–∫–æ–µ',
    'mixed': '–°–º–µ—à–∞–Ω–Ω–æ–µ',
    'other': '–î—Ä—É–≥–æ–µ'
   };
   return labels[value] || value;
  }
 </script>

 <script>
  // ===== –ü–†–û–°–¢–û–ô GIST –ú–ï–ù–ï–î–ñ–ï–† =====
  let currentGistId = null;

  // 1. –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ Gist
  async function loadFromGist() {
   const gistId = document.getElementById('gistIdInput').value;
   if (!gistId) {
    alert('–í–≤–µ–¥–∏—Ç–µ ID Gist');
    return;
   }

   try {
    const response = await fetch(`https://api.github.com/gists/${gistId}`);
    const gistData = await response.json();

    if (gistData.files && gistData.files['celebrities.json']) {
     // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
     celebrities = JSON.parse(gistData.files['celebrities.json'].content).map(normalizeCelebrityData);

     // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –µ—Å–ª–∏ –µ—Å—Ç—å
     if (gistData.files['trustedUsers.json']) {
      trustedUsers = JSON.parse(gistData.files['trustedUsers.json'].content);
      saveTrustedUsers();
      updateTrustedUsersList();
     }

     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–ª–∞–¥–µ–ª—å—Ü–µ Gist
     if (gistData.owner && gistData.owner.login) {
      localStorage.setItem('githubUser', gistData.owner.login);
     }

     saveData();
     renderCelebrities();
     currentGistId = gistId;
     alert('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
    }
   } catch (error) {
    alert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message);
   }
  }

  // 2. –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Gist
  async function saveToGist() {
   const gistId = document.getElementById('gistIdInput').value || currentGistId;
   if (!gistId) {
    alert('–í–≤–µ–¥–∏—Ç–µ ID Gist');
    return;
   }

   const token = prompt('–í–≤–µ–¥–∏—Ç–µ GitHub —Ç–æ–∫–µ–Ω:');
   if (!token) return;

   try {
    const userResponse = await fetch('https://api.github.com/user', {
     headers: { 'Authorization': `token ${token}` }
    });
    const userData = await userResponse.json();
    const userLogin = userData.login;

    if (!hasEditPermissions(userLogin)) {
     return alert('‚ùå –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –±–∞–∑—ã');
    }

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    localStorage.setItem('githubUser', userLogin);

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –∏–∑ Gist –¥–ª—è –º–µ—Ä–¥–∂–∞
    const currentResponse = await fetch(`https://api.github.com/gists/${gistId}`);
    const currentGist = await currentResponse.json();

    if (!currentGist.files || !currentGist.files['celebrities.json']) {
     throw new Error('Gist –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª–∞ celebrities.json');
    }

    const remoteData = JSON.parse(currentGist.files['celebrities.json'].content);
    const localData = celebrities;

    // –ú–µ—Ä–¥–∂–∏–º –¥–∞–Ω–Ω—ã–µ
    const mergedData = mergeData(remoteData, localData, userLogin);

    // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ payload
    const payload = {
     description: 'Celebrity catalog with access control - merged',
     public: false,
     files: {
      'celebrities.json': {
       content: JSON.stringify(mergedData, null, 2)
      },
      'trustedUsers.json': {
       content: JSON.stringify(trustedUsers, null, 2)
      }
     }
    };

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º
    const response = await fetch(`https://api.github.com/gists/${gistId}`, {
     method: 'PATCH',
     headers: {
      'Authorization': `token ${token}`,
      'Accept': 'application/vnd.github.v3+json',
      'Content-Type': 'application/json'
     },
     body: JSON.stringify(payload)
    });

    const data = await response.json();
    if (data.id) {
     currentGistId = data.id;
     document.getElementById('gistIdInput').value = currentGistId;

     // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é merged –¥–∞–Ω–Ω—ã–º–∏
     celebrities = mergedData;
     saveData();

     alert('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Å merge!');
    } else {
     throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å Gist');
    }
   } catch (error) {
    alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message);
   }
  }

  function mergeData(remoteData, localData, userLogin) {

   const normalizedRemote = remoteData.map(normalizeCelebrityData);
   const normalizedLocal = localData.map(normalizeCelebrityData);

   const merged = [...normalizedRemote];

   // –°–Ω–∞—á–∞–ª–∞ –æ—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å—Ç–∞—Ä—ã—Ö –ø–æ–º–µ—Ç–æ–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
   const cleanedLocalData = localData.map(item => {
    const cleanItem = { ...item };
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–ª—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
    delete cleanItem.mergeType;
    delete cleanItem.conflictResolved;
    // –ß–∏—Å—Ç–∏–º lastEditedBy –æ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö
    if (cleanItem.lastEditedBy && cleanItem.lastEditedBy.includes('–∫–æ–Ω—Ñ–ª–∏–∫—Ç')) {
     cleanItem.lastEditedBy = userLogin;
    }
    return cleanItem;
   });

   // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –û–ß–ò–©–ï–ù–ù–´–ú –ª–æ–∫–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º
   cleanedLocalData.forEach(localItem => {
    const existingIndex = merged.findIndex(r => r.id === localItem.id);

    if (existingIndex === -1) {
     // –ù–æ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ - –¥–æ–±–∞–≤–ª—è–µ–º
     merged.push({
      ...localItem,
      lastEditedBy: userLogin,
      mergeType: 'added'
     });
    } else {
     const remoteItem = merged[existingIndex];

     // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª
     const localUpdated = new Date(localItem.updatedAt || 0);
     const remoteUpdated = new Date(remoteItem.updatedAt || 0);

     if (localUpdated > remoteUpdated) {
      // –ù–∞—à–∞ –≤–µ—Ä—Å–∏—è –Ω–æ–≤–µ–µ - –∑–∞–º–µ–Ω—è–µ–º
      merged[existingIndex] = {
       ...localItem,
       lastEditedBy: userLogin,
       mergeType: 'updated'
      };
     }
     // –ï—Å–ª–∏ remote –Ω–æ–≤–µ–µ –∏–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –≤—Ä–µ–º—è - –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
     // –ù–ï —Å–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–æ–æ–±—â–µ!
    }
   });

   normalizedLocal.forEach(localItem => {
    const existingIndex = merged.findIndex(r => r.id === localItem.id);
    // ...
   });

   return merged;
  }

  function hasEditPermissions(githubLogin) {
   return trustedUsers.includes(githubLogin) || githubLogin === ADMIN_USERNAME;
  }

  // ===== –§–£–ù–ö–¶–ò–ò –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ò –£–î–ê–õ–ï–ù–ò–Ø =====
  function handleSubmit() {
   if (editingCelebrityId) {
    updateCelebrity();
   } else {
    addCelebrity();
   }
  }

  function editCelebrity(id) {
   const celeb = celebrities.find(c => c.id === id);
   if (!celeb) return;

   // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏
   document.getElementById('celebName').value = celeb.name;
   document.getElementById('celebBirthDate').value = celeb.birthDate || '';
   document.getElementById('celebIsDeceased').checked = celeb.isDeceased || false;
   document.getElementById('celebDeathDate').value = celeb.deathDate || '';
   document.getElementById('deathDateField').style.display = celeb.isDeceased ? 'block' : 'none';
   document.getElementById('celebHeight').value = celeb.height || '';

   // –¶–≤–µ—Ç –≤–æ–ª–æ—Å
   const hairSelect = document.getElementById('celebHairColor');
   Array.from(hairSelect.options).forEach(option => {
    option.selected = celeb.hairColor.includes(option.value);
   });

   // –¶–≤–µ—Ç –≥–ª–∞–∑
   const eyeSelect = document.getElementById('celebEyeColor');
   Array.from(eyeSelect.options).forEach(option => {
    option.selected = celeb.eyeColor.includes(option.value);
   });
   updateSelectedEyeColors();

   // –≠—Ç–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å
   const ethnicitySelect = document.getElementById('celebEthnicity');
   Array.from(ethnicitySelect.options).forEach(option => {
    option.selected = celeb.ethnicity.includes(option.value);
   });
   updateSelectedEthnicities();

   // –°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   const occupationSelect = document.getElementById('celebOccupation');
   Array.from(occupationSelect.options).forEach(option => {
    option.selected = celeb.occupation.includes(option.value);
   });
   updateSelectedOccupations();

   // –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ
   selectedCountries = [...celeb.citizenship];
   updateSelectedCountries();

   // –ü–æ–ª
   document.querySelectorAll('input[name="celebGender"]').forEach(radio => {
    radio.checked = (radio.value === celeb.gender);
   });

   document.getElementById('celebPhotoUrl').value = celeb.photo;
   document.getElementById('photoPreview').src = celeb.photo;
   document.getElementById('photoPreview').style.display = 'block';

   // –ú–µ–Ω—è–µ–º —Ä–µ–∂–∏–º –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   editingCelebrityId = id;
   document.getElementById('submitButton').innerHTML = '<i class="fas fa-save me-1"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
   document.getElementById('cancelEditButton').style.display = 'block';

   // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ñ–æ—Ä–º–µ
   document.querySelector('.add-form').open = true;
   document.querySelector('.add-form').scrollIntoView({ behavior: 'smooth' });
  }

  function updateCelebrity() {
   const celebIndex = celebrities.findIndex(c => c.id === editingCelebrityId);
   if (celebIndex === -1) return;

   // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã (–∫–∞–∫ –≤ addCelebrity)
   const name = document.getElementById('celebName').value;
   const birthDate = document.getElementById('celebBirthDate').value;
   const deathDate = document.getElementById('celebDeathDate').value;
   const height = document.getElementById('celebHeight').value;
   const hairColor = Array.from(document.getElementById('celebHairColor').selectedOptions)
    .map(opt => opt.value);
   const eyeColor = selectedEyeColors;
   const ethnicity = Array.from(document.getElementById('celebEthnicity').selectedOptions)
    .map(opt => opt.value);
   const occupation = Array.from(document.getElementById('celebOccupation').selectedOptions)
    .map(opt => opt.value);
   const gender = document.querySelector('input[name="celebGender"]:checked')?.value;
   const photoUrl = document.getElementById('celebPhotoUrl').value;

   if (!name || hairColor.length === 0 || !occupation || !gender) {
    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
    return;
   }

   const age = calculateAge(birthDate);
   const zodiac = getZodiacSign(birthDate);

   // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
   let editorInfo = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
   try {
    editorInfo = localStorage.getItem('githubUser') || '–õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
   } catch (e) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:', e);
   }

   // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
   celebrities[celebIndex] = {
    ...celebrities[celebIndex],
    name,
    birthDate,
    age,
    height: height || null,
    hairColor,
    eyeColor,
    ethnicity: ethnicity || null,
    citizenship: [...selectedCountries],
    occupation,
    gender,
    zodiac,
    photo: photoUrl || `https://placeholder.darth-kolmar.workers.dev?w=300&h=200&bg=cccccc&fg=333333&txt=${encodeURIComponent(name)}`,
    lastEditedBy: editorInfo,
    updatedAt: new Date().toISOString() // ‚Üê –î–û–ë–ê–í–¨–¢–ï –≠–¢–£ –°–¢–†–û–ß–ö–£
   };

   saveData();
   renderCelebrities();
   cancelEdit();
   alert('–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
  }

  function cancelEdit() {
   editingCelebrityId = null;
   document.getElementById('submitButton').innerHTML = '<i class="fas fa-plus me-1"></i> –î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å';
   document.getElementById('cancelEditButton').style.display = 'none';
   resetForm();
  }

  function deleteCelebrity(id) {
   if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å –∏–∑ –±–∞–∑—ã?')) return;

   celebrities = celebrities.filter(c => c.id !== id);
   saveData();
   renderCelebrities();
   alert('–ó–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞!');
  }

  function getGenderOccupation(occupation, gender) {
   const occupations = {
    '–∞–∫—Ç—ë—Ä': { –º—É–∂—á–∏–Ω–∞: '–∞–∫—Ç—ë—Ä', –∂–µ–Ω—â–∏–Ω–∞: '–∞–∫—Ç—Ä–∏—Å–∞' },
    '–º—É–∑—ã–∫–∞–Ω—Ç': { –º—É–∂—á–∏–Ω–∞: '–º—É–∑—ã–∫–∞–Ω—Ç', –∂–µ–Ω—â–∏–Ω–∞: '–º—É–∑—ã–∫–∞–Ω—Ç' },
    '—Å–ø–æ—Ä—Ç—Å–º–µ–Ω': { –º—É–∂—á–∏–Ω–∞: '—Å–ø–æ—Ä—Ç—Å–º–µ–Ω', –∂–µ–Ω—â–∏–Ω–∞: '—Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞' },
    '–º–æ–¥–µ–ª—å': { –º—É–∂—á–∏–Ω–∞: '–º–æ–¥–µ–ª—å', –∂–µ–Ω—â–∏–Ω–∞: '–º–æ–¥–µ–ª—å' },
    '–±–ª–æ–≥–µ—Ä': { –º—É–∂—á–∏–Ω–∞: '–±–ª–æ–≥–µ—Ä', –∂–µ–Ω—â–∏–Ω–∞: '–±–ª–æ–≥–µ—Ä—à–∞' },
    '–¥—Ä—É–≥–æ–µ': { –º—É–∂—á–∏–Ω–∞: '–¥—Ä—É–≥–æ–µ', –∂–µ–Ω—â–∏–Ω–∞: '–¥—Ä—É–≥–æ–µ' }
   };

   return occupations[occupation]?.[gender] || occupation;
  }

  function getBaseHairColor(color) {
   const baseColors = {
    '–±–ª–æ–Ω–¥–∏–Ω–∫–∞': '–±–ª–æ–Ω–¥–∏–Ω',
    '–±—Ä—é–Ω–µ—Ç–∫–∞': '–±—Ä—é–Ω–µ—Ç',
    '—à–∞—Ç–µ–Ω–∫–∞': '—à–∞—Ç–µ–Ω',
    '—Ä—ã–∂–∞—è': '—Ä—ã–∂–∏–π',
    '—Å–µ–¥–∞—è': '—Å–µ–¥–æ–π'
   };
   return baseColors[color] || color;
  }

  function getGenderHairColor(color, gender) {
   const hairColors = {
    '–±–ª–æ–Ω–¥–∏–Ω': { –º—É–∂—á–∏–Ω–∞: '–±–ª–æ–Ω–¥–∏–Ω', –∂–µ–Ω—â–∏–Ω–∞: '–±–ª–æ–Ω–¥–∏–Ω–∫–∞' },
    '–±—Ä—é–Ω–µ—Ç': { –º—É–∂—á–∏–Ω–∞: '–±—Ä—é–Ω–µ—Ç', –∂–µ–Ω—â–∏–Ω–∞: '–±—Ä—é–Ω–µ—Ç–∫–∞' },
    '—à–∞—Ç–µ–Ω': { –º—É–∂—á–∏–Ω–∞: '—à–∞—Ç–µ–Ω', –∂–µ–Ω—â–∏–Ω–∞: '—à–∞—Ç–µ–Ω–∫–∞' },
    '—Ä—ã–∂–∏–π': { –º—É–∂—á–∏–Ω–∞: '—Ä—ã–∂–∏–π', –∂–µ–Ω—â–∏–Ω–∞: '—Ä—ã–∂–∞—è' },
    '—Å–µ–¥–æ–π': { –º—É–∂—á–∏–Ω–∞: '—Å–µ–¥–æ–π', –∂–µ–Ω—â–∏–Ω–∞: '—Å–µ–¥–∞—è' },
    '–¥—Ä—É–≥–æ–µ': { –º—É–∂—á–∏–Ω–∞: '–¥—Ä—É–≥–æ–µ', –∂–µ–Ω—â–∏–Ω–∞: '–¥—Ä—É–≥–æ–µ' }
   };

   return hairColors[color]?.[gender] || color;
  }

  function getAgeWord(age) {
   if (age % 10 === 1 && age % 100 !== 11) {
    return '–≥–æ–¥';
   } else if ([2, 3, 4].includes(age % 10) && ![12, 13, 14].includes(age % 100)) {
    return '–≥–æ–¥–∞';
   } else {
    return '–ª–µ—Ç';
   }
  }

  function getDeathWord(gender) {
   if (gender === '–∂–µ–Ω—â–∏–Ω–∞') {
    return '—É–º–µ—Ä–ª–∞';
   } else {
    return '—É–º–µ—Ä';
   }
  }

  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —ç—Ç–Ω–∏—á–µ—Å–∫–æ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏
  function updateSelectedEthnicities() {
   const ethnicitySelect = document.getElementById('celebEthnicity');
   selectedEthnicities = Array.from(ethnicitySelect.selectedOptions).map(opt => opt.value);

   const container = document.getElementById('selectedEthnicities');
   if (!container) return;

   container.innerHTML = '';

   if (selectedEthnicities.length === 0) {
    container.innerHTML = '<span class="text-muted">–≠—Ç–Ω–∏—á–Ω–æ—Å—Ç–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</span>';
    return;
   }

   selectedEthnicities.forEach(ethnicity => {
    const badge = document.createElement('span');
    badge.className = 'badge bg-info me-1 mb-1';
    badge.innerHTML = `${getEthnicityLabel(ethnicity)} 
                          <span style="cursor:pointer; margin-left:5px;" onclick="removeEthnicity('${ethnicity}')">√ó</span>`;
    container.appendChild(badge);
   });
  }

  function removeEthnicity(ethnicity) {
   const select = document.getElementById('celebEthnicity');
   const options = select.options;

   for (let i = 0; i < options.length; i++) {
    if (options[i].value === ethnicity) {
     options[i].selected = false;
     break;
    }
   }

   updateSelectedEthnicities();
  }

  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å—Ñ–µ—Ä –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  function updateSelectedOccupations() {
   const occupationSelect = document.getElementById('celebOccupation');
   selectedOccupations = Array.from(occupationSelect.selectedOptions).map(opt => opt.value);

   const container = document.getElementById('selectedOccupations');
   if (!container) return;

   container.innerHTML = '';

   if (selectedOccupations.length === 0) {
    container.innerHTML = '<span class="text-muted">–°—Ñ–µ—Ä—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</span>';
    return;
   }

   selectedOccupations.forEach(occupation => {
    const badge = document.createElement('span');
    badge.className = 'badge bg-success me-1 mb-1';
    badge.innerHTML = `${getOccupationLabel(occupation)} 
                          <span style="cursor:pointer; margin-left:5px;" onclick="removeOccupation('${occupation}')">√ó</span>`;
    container.appendChild(badge);
   });
  }

  function removeOccupation(occupation) {
   const select = document.getElementById('celebOccupation');
   const options = select.options;

   for (let i = 0; i < options.length; i++) {
    if (options[i].value === occupation) {
     options[i].selected = false;
     break;
    }
   }

   updateSelectedOccupations();
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è label –∑–∞–Ω—è—Ç–∏—è
  function getOccupationLabel(value) {
   const labels = {
    '–∞–∫—Ç—ë—Ä': '–ê–∫—Ç—ë—Ä',
    '–º—É–∑—ã–∫–∞–Ω—Ç': '–ú—É–∑—ã–∫–∞–Ω—Ç',
    '—Å–ø–æ—Ä—Ç—Å–º–µ–Ω': '–°–ø–æ—Ä—Ç—Å–º–µ–Ω',
    '–º–æ–¥–µ–ª—å': '–ú–æ–¥–µ–ª—å',
    '–±–ª–æ–≥–µ—Ä': '–ë–ª–æ–≥–µ—Ä',
    '–ø–æ–ª–∏—Ç–∏–∫': '–ü–æ–ª–∏—Ç–∏–∫',
    '—É—á–µ–Ω—ã–π': '–£—á–µ–Ω—ã–π',
    '–ø–∏—Å–∞—Ç–µ–ª—å': '–ü–∏—Å–∞—Ç–µ–ª—å',
    '—Ö—É–¥–æ–∂–Ω–∏–∫': '–•—É–¥–æ–∂–Ω–∏–∫',
    '–¥—Ä—É–≥–æ–µ': '–î—Ä—É–≥–æ–µ'
   };
   return labels[value] || value;
  }

  function renderPagination(totalItems) {
   const totalPages = Math.ceil(totalItems / itemsPerPage);

   // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –ø–∞–≥–∏–Ω–∞—Ü–∏—é –µ—Å–ª–∏ –µ—Å—Ç—å
   const oldPagination = document.getElementById('pagination');
   if (oldPagination) oldPagination.remove();

   if (totalPages <= 1) return; // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é –µ—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–¥–Ω–∞

   const pagination = document.createElement('nav');
   pagination.id = 'pagination';
   pagination.innerHTML = `
        <ul class="pagination justify-content-center mt-4">
            <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                <button class="page-link" onclick="changePage(${currentPage - 1})">‚Üê –ù–∞–∑–∞–¥</button>
            </li>
            
            ${Array.from({ length: totalPages }, (_, i) => i + 1)
     .map(page => `
                    <li class="page-item ${page === currentPage ? 'active' : ''}">
                        <button class="page-link" onclick="changePage(${page})">${page}</button>
                    </li>
                `).join('')}
            
            <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                <button class="page-link" onclick="changePage(${currentPage + 1})">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
            </li>
        </ul>
        
        <div class="text-center text-muted mt-2">
            –ü–æ–∫–∞–∑–∞–Ω–æ ${((currentPage - 1) * itemsPerPage) + 1}-${Math.min(currentPage * itemsPerPage, totalItems)} –∏–∑ ${totalItems}
        </div>
    `;

   document.getElementById('celebritiesList').after(pagination);
  }

  function changePage(page) {
   currentPage = page;
   renderFilteredCelebrityPage(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π
   window.scrollTo({ top: 0, behavior: 'smooth' }); // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö
  }

  // ===== –°–ò–°–¢–ï–ú–ê –£–ü–†–ê–í–õ–ï–ù–ò–Ø –î–û–°–¢–£–ü–û–ú =====
  function hasEditPermissions(githubLogin) {
   return trustedUsers.includes(githubLogin) || githubLogin === ADMIN_USERNAME;
  }

  async function addTrustedUser() {
   const username = document.getElementById('addUserInput').value.trim();
   if (!username) return alert('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω GitHub');

   const token = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à GitHub —Ç–æ–∫–µ–Ω –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–∞–≤:');
   if (!token) return;

   try {
    const userResponse = await fetch('https://api.github.com/user', {
     headers: { 'Authorization': `token ${token}` }
    });

    if (!userResponse.ok) throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω');

    const userData = await userResponse.json();
    const currentUser = userData.login;

    if (currentUser !== ADMIN_USERNAME) {
     return alert('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
    }

    const userCheck = await fetch(`https://api.github.com/users/${username}`);
    if (!userCheck.ok) return alert('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å GitHub –Ω–µ –Ω–∞–π–¥–µ–Ω');

    if (!trustedUsers.includes(username)) {
     trustedUsers.push(username);
     saveTrustedUsers();
     updateTrustedUsersList();
     alert(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ!`);
    } else {
     alert('‚ö†Ô∏è –≠—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ');
    }

   } catch (error) {
    alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
   }
  }

  async function removeTrustedUser(username) {
   const token = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à GitHub —Ç–æ–∫–µ–Ω –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:');
   if (!token) return;

   try {
    const userResponse = await fetch('https://api.github.com/user', {
     headers: { 'Authorization': `token ${token}` }
    });

    const userData = await userResponse.json();
    const currentUser = userData.login;

    if (currentUser !== ADMIN_USERNAME) {
     return alert('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
    }

    trustedUsers = trustedUsers.filter(user => user !== username);
    saveTrustedUsers();
    updateTrustedUsersList();
    alert(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} —É–¥–∞–ª–µ–Ω –∏–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö`);

   } catch (error) {
    alert('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
   }
  }

  function saveTrustedUsers() {
   localStorage.setItem('trustedUsers', JSON.stringify(trustedUsers));
  }

  function loadTrustedUsers() {
   const saved = localStorage.getItem('trustedUsers');
   if (saved) trustedUsers = JSON.parse(saved);
   updateTrustedUsersList();
  }

  function updateTrustedUsersList() {
   const container = document.getElementById('trustedUsersList');
   container.innerHTML = '';

   if (trustedUsers.length === 0) {
    container.innerHTML = '<div class="text-muted">–ù–µ—Ç –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
    return;
   }

   container.innerHTML = trustedUsers.map(user => `
          <div class="d-flex justify-content-between align-items-center mb-1 p-2 border rounded">
              <span>${user}</span>
              <button class="btn btn-sm btn-danger" onclick="removeTrustedUser('${user}')">
                  <i class="fas fa-times"></i>
              </button>
          </div>
      `).join('');
  }


  let sortNewestFirst = true;

  function changeSortOrder(order) {
   currentSortOrder = order;
   renderCelebrities();
   updateSortButtonText();
  }

  function updateSortButtonText() {
   const button = document.querySelector('#sortDropdown');
   if (!button) return;

   const icons = {
    'newest': 'fas fa-sort-amount-down-alt',
    'oldest': 'fas fa-sort-amount-up-alt',
    'az': 'fas fa-sort-alpha-down',
    'za': 'fas fa-sort-alpha-up-alt'
   };

   // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
   const iconElement = button.querySelector('i');
   if (iconElement) {
    iconElement.className = icons[currentSortOrder] || 'fas fa-sort';
   }
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º renderCelebrities()
  function renderCelebrities() {
   let sortedCelebrities = [...celebrities];

   // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
   switch (currentSortOrder) {
    case 'newest':
     sortedCelebrities.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
     break;
    case 'oldest':
     sortedCelebrities.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
     break;
    case 'az':
     sortedCelebrities.sort((a, b) => a.name.localeCompare(b.name));
     break;
    case 'za':
     sortedCelebrities.sort((a, b) => b.name.localeCompare(a.name));
     break;
    default:
     sortedCelebrities.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
   }

   filteredData = sortedCelebrities;
   currentPage = 1;
   renderFilteredCelebrityPage();
  }

  function changeSortOrder(order) {
   currentSortOrder = order;
   localStorage.setItem('sortOrder', order); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä
   renderCelebrities();
   updateSortButtonText();
  }

  // –ò –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ
  function loadData() {
   const savedData = localStorage.getItem('celebritiesData');
   if (savedData) {
    celebrities = JSON.parse(savedData).map(normalizeCelebrityData);
   }

   // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
   const savedSortOrder = localStorage.getItem('sortOrder');
   if (savedSortOrder) {
    currentSortOrder = savedSortOrder;
   }

   renderCelebrities();
  }
 </script>

</body>

</html>